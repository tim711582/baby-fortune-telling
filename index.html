<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>寶寶扶養指南 - 八字分析</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <h1><i class="fas fa-baby"></i> 寶寶扶養指南</h1>
            <p>基於八字分析的0-10歲寶寶成長指導</p>
            <button id="settingsBtn" class="settings-btn" title="設定">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </header>

    <main class="container">
        <section class="input-section">
            <h2>輸入寶寶出生資訊</h2>
            <form id="birthForm">
                <div class="form-group">
                    <label for="babyName">寶寶姓名 <span class="optional">(選填)</span></label>
                    <input type="text" id="babyName" placeholder="請輸入寶寶姓名">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="birthYear">出生年份</label>
                        <select id="birthYear" required></select>
                    </div>
                    <div class="form-group">
                        <label for="birthMonth">出生月份</label>
                        <select id="birthMonth" required></select>
                    </div>
                    <div class="form-group">
                        <label for="birthDay">出生日期</label>
                        <select id="birthDay" required></select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="birthHour">出生時間</label>
                        <select id="birthHour" required></select>
                    </div>
                    <div class="form-group">
                        <label for="gender">性別</label>
                        <select id="gender" required>
                            <option value="">請選擇</option>
                            <option value="male">男</option>
                            <option value="female">女</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="birthPlace">出生地點</label>
                    <input type="text" id="birthPlace" placeholder="請輸入城市名稱，例如：台北市" required>
                </div>
                
                <div class="form-group">
                    <label for="timezone">時區</label>
                    <select id="timezone" required>
                        <option value="">請選擇時區</option>
                        <option value="Asia/Taipei" selected>台灣時間 (UTC+8)</option>
                        <option value="Asia/Shanghai">中國標準時間 (UTC+8)</option>
                        <option value="Asia/Hong_Kong">香港時間 (UTC+8)</option>
                        <option value="Asia/Singapore">新加坡時間 (UTC+8)</option>
                        <option value="America/New_York">美國東部時間 (UTC-5/-4)</option>
                        <option value="America/Los_Angeles">美國西部時間 (UTC-8/-7)</option>
                        <option value="Europe/London">英國時間 (UTC+0/+1)</option>
                        <option value="Australia/Sydney">澳洲東部時間 (UTC+10/+11)</option>
                    </select>
                </div>
                
                <div class="form-group lunar-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="knowLunar">
                        <span class="checkmark"></span>
                        我知道農曆生日和閏月資訊
                    </label>
                </div>
                
                <div id="lunarDetails" class="lunar-details hidden">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="lunarYear">農曆年份</label>
                            <select id="lunarYear"></select>
                        </div>
                        <div class="form-group">
                            <label for="lunarMonth">農曆月份</label>
                            <select id="lunarMonth"></select>
                        </div>
                        <div class="form-group">
                            <label for="lunarDay">農曆日期</label>
                            <select id="lunarDay"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="isLeapMonth">
                            <span class="checkmark"></span>
                            閏月
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="btn-primary">開始分析寶寶特質</button>
            </form>
        </section>

        <section id="results" class="results-section hidden">
            <div class="tabs">
                <button class="tab-btn active" data-tab="overview">八字總覽</button>
                <button class="tab-btn" data-tab="personality">性格分析</button>
                <button class="tab-btn" data-tab="monthly">月份指南</button>
                <button class="tab-btn" data-tab="chart">成長圖表</button>
            </div>

            <div id="overview" class="tab-content active">
                <h2>八字總覽</h2>
                
                <!-- 基本資訊卡片 -->
                <div class="bazi-overview-container">
                    <!-- 出生資訊 -->
                    <div class="info-card birth-info-card">
                        <div class="card-header">
                            <h3><i class="fas fa-calendar-alt"></i> 出生資訊</h3>
                        </div>
                        <div class="card-content">
                            <div class="info-row">
                                <span class="label">陽曆：</span>
                                <span id="solarDate" class="value">2025年2月7日3時</span>
                            </div>
                            <div class="info-row">
                                <span class="label">農曆：</span>
                                <span id="lunarDate" class="value">2025年1月10日寅時</span>
                            </div>
                            <div class="info-row">
                                <span class="label">干支：</span>
                                <span id="ganzhiDate" class="value">乙巳年戊寅月丁未日壬寅時</span>
                            </div>
                            <div class="info-row">
                                <span class="label">本命：</span>
                                <span id="mainDestiny" class="value destiny-highlight"></span>
                            </div>
                        </div>
                    </div>

                    <!-- 八字四柱 -->
                    <div class="info-card bazi-pillars-card">
                        <div class="card-header">
                            <h3><i class="fas fa-yin-yang"></i> 八字四柱</h3>
                        </div>
                        <div class="card-content">
                            <div class="pillars-container">
                                <div class="pillar-item">
                                    <div class="pillar-label">年柱</div>
                                    <div id="yearPillar" class="pillar-value"></div>
                                    <div class="pillar-element" id="yearElement"></div>
                                </div>
                                <div class="pillar-item">
                                    <div class="pillar-label">月柱</div>
                                    <div id="monthPillar" class="pillar-value"></div>
                                    <div class="pillar-element" id="monthElement"></div>
                                </div>
                                <div class="pillar-item">
                                    <div class="pillar-label">日柱</div>
                                    <div id="dayPillar" class="pillar-value"></div>
                                    <div class="pillar-element" id="dayElement"></div>
                                </div>
                                <div class="pillar-item">
                                    <div class="pillar-label">時柱</div>
                                    <div id="hourPillar" class="pillar-value"></div>
                                    <div class="pillar-element" id="hourElement"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 五行分析 -->
                    <div class="info-card elements-card">
                        <div class="card-header">
                            <h3><i class="fas fa-leaf"></i> 五行分析</h3>
                        </div>
                        <div class="card-content">
                            <div class="elements-summary">
                                <div class="element-stats" id="elementStats"></div>
                                <div class="element-chart-mini">
                                    <canvas id="elementsChart" width="200" height="200"></canvas>
                                </div>
                            </div>
                            <div class="elements-details">
                                <div class="element-analysis">
                                    <div class="analysis-item">
                                        <span class="analysis-label">日主五行：</span>
                                        <span id="dayMainElement" class="analysis-value"></span>
                                    </div>
                                    <div class="analysis-item">
                                        <span class="analysis-label">五行強弱：</span>
                                        <span id="elementStrength" class="analysis-value"></span>
                                    </div>
                                    <div class="analysis-item">
                                        <span class="analysis-label">喜用神：</span>
                                        <span id="favorableElements" class="analysis-value"></span>
                                    </div>
                                    <div class="analysis-item">
                                        <span class="analysis-label">忌神：</span>
                                        <span id="unfavorableElements" class="analysis-value"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 命理特徵 -->
                    <div class="info-card destiny-features-card">
                        <div class="card-header">
                            <h3><i class="fas fa-star"></i> 命理特徵</h3>
                        </div>
                        <div class="card-content">
                            <div class="features-grid">
                                <div class="feature-item">
                                    <div class="feature-label">五行局</div>
                                    <div id="wuxingJu" class="feature-value"></div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-label">生年四化</div>
                                    <div id="sihua" class="feature-value"></div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-label">命主星</div>
                                    <div id="mingzhu" class="feature-value"></div>
                                </div>
                                <div class="feature-item">
                                    <div class="feature-label">納音</div>
                                    <div id="nayin" class="feature-value"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 天干地支詳解 -->
                    <div class="info-card stems-branches-card">
                        <div class="card-header">
                            <h3><i class="fas fa-tree"></i> 天干地支詳解</h3>
                        </div>
                        <div class="card-content">
                            <div class="stems-branches-grid">
                                <div class="sb-section">
                                    <h4>天干</h4>
                                    <div class="sb-items" id="stemsDetails"></div>
                                </div>
                                <div class="sb-section">
                                    <h4>地支</h4>
                                    <div class="sb-items" id="branchesDetails"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 整體分析 -->
                    <div class="info-card overall-analysis-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> 整體分析</h3>
                        </div>
                        <div class="card-content">
                            <div id="overallAnalysis" class="analysis-text"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="personality" class="tab-content">
                <h2>性格分析與扶養指南</h2>
                
                <!-- 整體摘要 -->
                <div class="personality-section">
                    <h3><i class="fas fa-star"></i> 整體摘要（0-6歲）</h3>
                    <div class="overall-summary">
                        <div class="summary-card">
                            <h4><i class="fas fa-heart"></i> 性格重點</h4>
                            <div id="personalityHighlights" class="summary-content"></div>
                        </div>
                        <div class="summary-card">
                            <h4><i class="fas fa-calendar-alt"></i> 年齡段摘要</h4>
                            <div id="ageStageSummary" class="summary-content"></div>
                        </div>
                        <div class="summary-card">
                            <h4><i class="fas fa-users"></i> 團體生活建議</h4>
                            <div id="groupLifeAdvice" class="summary-content"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 基本性格特質 -->
                <div class="personality-section">
                    <h3><i class="fas fa-user-circle"></i> 基本性格特質</h3>
                    <div class="personality-traits">
                        <div id="mainTraits" class="traits-container"></div>
                    </div>
                    <div class="personality-details">
                        <div id="personalityDetails" class="analysis-text"></div>
                    </div>
                </div>

                <!-- 年齡階段性格變化 -->
                <div class="personality-section">
                    <h3><i class="fas fa-chart-line"></i> 年齡階段性格變化</h3>
                    <div class="age-stages">
                        <div class="stage-card" data-age="0-2">
                            <h4>0-2歲 嬰幼兒期</h4>
                            <div class="stage-content">
                                <div class="personality-traits-stage">
                                    <h5>性格特點：</h5>
                                    <ul id="traits-0-2">
                                        <li>天生氣質較為敏感，對環境變化反應明顯</li>
                                        <li>情緒表達直接，哭鬧時需要耐心安撫</li>
                                        <li>對聲音和光線較為敏感，需要溫和的環境</li>
                                        <li>依賴性強，需要充分的安全感</li>
                                    </ul>
                                </div>
                                <div class="parenting-tips">
                                    <h5>扶養注意事項：</h5>
                                    <ul>
                                        <li>建立規律的作息時間，提供穩定的環境</li>
                                        <li>多給予肌膚接觸和溫柔的聲音安撫</li>
                                        <li>避免過度刺激，保持環境的安靜舒適</li>
                                        <li>及時回應寶寶的需求，建立信任感</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="stage-card" data-age="3-5">
                            <h4>3-5歲 學前期</h4>
                            <div class="stage-content">
                                <div class="personality-traits-stage">
                                    <h5>性格特點：</h5>
                                    <ul id="traits-3-5">
                                        <li>好奇心旺盛，喜歡探索和提問</li>
                                        <li>想像力豐富，創造力開始顯現</li>
                                        <li>情緒波動較大，需要學習情緒管理</li>
                                        <li>開始展現獨立性，但仍需要指導</li>
                                    </ul>
                                </div>
                                <div class="parenting-tips">
                                    <h5>扶養注意事項：</h5>
                                    <ul>
                                        <li>鼓勵探索但設定安全界限</li>
                                        <li>培養基本的生活自理能力</li>
                                        <li>教導情緒表達的適當方式</li>
                                        <li>提供豐富的學習和遊戲機會</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="stage-card" data-age="6-8">
                            <h4>6-8歲 學齡初期</h4>
                            <div class="stage-content">
                                <div class="personality-traits-stage">
                                    <h5>性格特點：</h5>
                                    <ul id="traits-6-8">
                                        <li>學習能力強，對知識有渴望</li>
                                        <li>社交能力發展，開始建立友誼</li>
                                        <li>責任感逐漸形成，能承擔簡單任務</li>
                                        <li>自我意識增強，開始有自己的想法</li>
                                    </ul>
                                </div>
                                <div class="parenting-tips">
                                    <h5>扶養注意事項：</h5>
                                    <ul>
                                        <li>建立良好的學習習慣和環境</li>
                                        <li>培養社交技能和團隊合作精神</li>
                                        <li>給予適當的責任和自主權</li>
                                        <li>鼓勵表達想法，培養批判思維</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="stage-card" data-age="9-10">
                            <h4>9-10歲 學齡中期</h4>
                            <div class="stage-content">
                                <div class="personality-traits-stage">
                                    <h5>性格特點：</h5>
                                    <ul id="traits-9-10">
                                        <li>邏輯思維能力增強，能理解複雜概念</li>
                                        <li>價值觀開始形成，對公平正義有概念</li>
                                        <li>同儕關係重要性增加</li>
                                        <li>開始關注自己的能力和表現</li>
                                    </ul>
                                </div>
                                <div class="parenting-tips">
                                    <h5>扶養注意事項：</h5>
                                    <ul>
                                        <li>引導建立正確的價值觀和道德觀</li>
                                        <li>培養解決問題的能力</li>
                                        <li>支持健康的同儕交往</li>
                                        <li>鼓勵發展個人興趣和專長</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 教育建議 -->
                <div class="personality-section">
                    <h3><i class="fas fa-graduation-cap"></i> 教育建議</h3>
                    <div class="education-tips">
                        <div class="tip-category">
                            <h4>學習方式</h4>
                            <div id="learningStyle" class="tip-content">
                                <p>根據八字分析，建議採用以下學習方式：</p>
                                <ul>
                                    <li>視覺學習：使用圖表、圖片和色彩豐富的教材</li>
                                    <li>體驗學習：通過實際操作和體驗來學習</li>
                                    <li>循序漸進：按部就班，不急於求成</li>
                                </ul>
                            </div>
                        </div>
                        <div class="tip-category">
                            <h4>溝通方式</h4>
                            <div id="communicationStyle" class="tip-content">
                                <p>與孩子溝通時建議：</p>
                                <ul>
                                    <li>耐心傾聽，給予充分的表達機會</li>
                                    <li>使用正面的語言和鼓勵</li>
                                    <li>設定清晰的界限和期望</li>
                                </ul>
                            </div>
                        </div>
                        <div class="tip-category">
                            <h4>興趣培養</h4>
                            <div id="interestDevelopment" class="tip-content">
                                <p>建議培養的興趣方向：</p>
                                <ul>
                                    <li>藝術創作：繪畫、音樂、手工等</li>
                                    <li>運動活動：游泳、跑步、球類運動</li>
                                    <li>閱讀寫作：培養語言表達能力</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 健康管理 -->
                <div class="personality-section">
                    <h3><i class="fas fa-heart"></i> 健康管理建議</h3>
                    <div class="health-tips">
                        <div class="health-category">
                            <h4>體質特點</h4>
                            <div id="physicalConstitution" class="health-content">
                                <p>根據八字分析的體質特點和注意事項</p>
                            </div>
                        </div>
                        <div class="health-category">
                            <h4>飲食建議</h4>
                            <div id="dietaryAdvice" class="health-content">
                                <p>適合的飲食類型和需要避免的食物</p>
                            </div>
                        </div>
                        <div class="health-category">
                            <h4>運動建議</h4>
                            <div id="exerciseAdvice" class="health-content">
                                <p>適合的運動類型和運動強度</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="monthly" class="tab-content">
                <h2>0-12月月齡表格</h2>
                <p class="monthly-description">根據寶寶八字特質，提供每個月齡階段的帶養特色、挑戰與照護建議</p>
                <div class="monthly-table-container" id="monthlyTableContainer">
                    <!-- 月齡表格將在這裡動態生成 -->
                </div>
            </div>

            <div id="chart" class="tab-content">
                <h2>0-12月好帶指數</h2>
                <div class="chart-options">
                    <div class="download-buttons">
                        <button type="button" class="download-btn" onclick="baziCharts.downloadChartAsPNG('growthChart', '寶寶好帶指數圖表')">
                            <i class="fas fa-download"></i> 下載PNG
                        </button>
                        <button type="button" class="download-btn" onclick="baziCharts.downloadChartAsPDF('growthChart', '寶寶好帶指數圖表')">
                            <i class="fas fa-file-pdf"></i> 下載PDF
                        </button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="growthChart"></canvas>
                </div>
                <div id="chartAnalysis" class="analysis-text"></div>
            </div>
        </section>
    </main>

    <!-- 設定模態框 -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> 設定</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="apiKeyInput">OpenAI API 金鑰</label>
                    <div class="api-key-container">
                        <input type="password" id="apiKeyInput" placeholder="請輸入您的 OpenAI API 金鑰">
                        <button type="button" id="toggleApiKey" class="toggle-btn">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <small class="help-text">
                        您的 API 金鑰將安全地儲存在瀏覽器本地，不會上傳到任何伺服器。
                        <a href="https://platform.openai.com/api-keys" target="_blank">如何獲取 API 金鑰？</a>
                    </small>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="enableGPTAnalysis">
                        啟用 GPT AI 分析
                    </label>
                    <small class="help-text">使用 AI 生成更個性化的分析內容</small>
                </div>
                <div class="setting-group">
                    <div class="api-status">
                        <span class="status-label">API 狀態：</span>
                        <span id="apiStatus" class="status-indicator">未設定</span>
                    </div>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="showCharts" checked>
                        顯示圖表
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="showDetailedAnalysis" checked>
                        顯示詳細分析
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveSettings" class="btn-primary">儲存設定</button>
                <button type="button" id="testApi" class="btn-secondary">測試連接</button>
                <button type="button" id="clearSettings" class="btn-danger">清除設定</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2023 寶寶扶養指南 - 基於八字分析的育兒指導平台</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="js/bazi-calculator.js"></script>
    <script src="js/analysis.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/gpt-service.js"></script>
    <script src="js/main.js"></script>
    <script src="js/settings.js"></script>
</body>
</html>